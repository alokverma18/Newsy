<div class="app-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <h1>{{ title }}</h1>
      </div>

      <div class="header-actions">
        <button class="btn btn-refresh btn-icon-only" (click)="refreshNews()" [disabled]="loading">
          <i-lucide [img]="RefreshCw" class="icon"></i-lucide>
        </button>

        <button class="btn btn-subscribe btn-icon-only" (click)="openSubscriptionModal()">
          <i-lucide [img]="Bell" class="icon"></i-lucide>
        </button>

        <button class="btn btn-theme btn-icon-only" (click)="toggleTheme()">
          <i-lucide [img]="isDarkMode ? Sun : Moon" class="icon"></i-lucide>
        </button>
      </div>
    </div>
  </header>

  <!-- Category Filter -->
  <nav class="category-nav">
    <div class="category-pills">
      <button
        class="category-pill"
        [class.active]="selectedCategory === 'all'"
        (click)="selectCategory('all')">
        <i-lucide [img]="Layers" class="category-icon"></i-lucide>
        <span class="category-name">All</span>
      </button>
      <button
        class="category-pill"
        [class.active]="selectedCategory === 'technology'"
        (click)="selectCategory('technology')">
        <i-lucide [img]="Cpu" class="category-icon"></i-lucide>
        <span class="category-name">Technology</span>
      </button>
      <button
        class="category-pill"
        [class.active]="selectedCategory === 'sports'"
        (click)="selectCategory('sports')">
        <i-lucide [img]="Trophy" class="category-icon"></i-lucide>
        <span class="category-name">Sports</span>
      </button>
      <button
        class="category-pill"
        [class.active]="selectedCategory === 'business'"
        (click)="selectCategory('business')">
        <i-lucide [img]="Briefcase" class="category-icon"></i-lucide>
        <span class="category-name">Business</span>
      </button>
      <button
        class="category-pill"
        [class.active]="selectedCategory === 'education'"
        (click)="selectCategory('education')">
        <i-lucide [img]="GraduationCap" class="category-icon"></i-lucide>
        <span class="category-name">Education</span>
      </button>
      <button
        class="category-pill"
        [class.active]="selectedCategory === 'entertainment'"
        (click)="selectCategory('entertainment')">
        <i-lucide [img]="Sparkles" class="category-icon"></i-lucide>
        <span class="category-name">Entertainment</span>
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container">
      <div class="spinner"></div>
      <p>Loading latest news...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-container">
      <i-lucide [img]="AlertCircle" class="error-icon"></i-lucide>
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="loadNews()">Try Again</button>
    </div>

    <!-- News Grid -->
    <div *ngIf="!loading && !error && newsData" class="news-grid">
      <article
        *ngFor="let article of getFilteredNews()"
        class="news-card"
        (click)="openArticle(article.url)">

        <!-- Image -->
        <div class="card-image">
          <img
            [src]="article.imageUrl"
            [alt]="article.title"
            loading="lazy"
            (error)="$any($event.target).src = getDefaultImageForCategory(article.category)">
          <div class="category-badge">{{ article.category }}</div>
        </div>

        <!-- Content -->
        <div class="card-content">
          <h2 class="card-title">{{ article.title }}</h2>
          <p class="card-description">{{ article.description }}</p>

          <div class="card-footer">
            <div class="source-info">
              <img
                [src]="article.sourceIcon"
                [alt]="article.source"
                class="source-icon"
                onerror="this.src='https://www.google.com/s2/favicons?domain=news.com&sz=64'">
              <div class="source-details">
                <span class="source-name">{{ article.source }}</span>
                <span class="publish-date">{{ formatDate(article.publishedAt) }}</span>
              </div>
            </div>

            <button class="read-more-btn">
              <span>Read More</span>
              <i-lucide [img]="ArrowRight" class="arrow"></i-lucide>
            </button>
          </div>
        </div>
      </article>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && newsData && getFilteredNews().length === 0" class="empty-state">
      <i-lucide [img]="Inbox" class="empty-icon"></i-lucide>
      <h2>No news available</h2>
      <p>Try refreshing or selecting a different category</p>
      <button class="btn btn-primary" (click)="refreshNews()">Fetch Latest News</button>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>&copy; 2025 Newsy. Powered by NewsData.io</p>
  </footer>
</div>
